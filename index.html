<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>그해 우리들의 블루스</title>
    <style>
        body {
            margin: 0;
            padding: 0;
            height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            font-family: 'Arial', sans-serif;
            overflow: hidden;
            background-image: url('bg.jpg');
            background-size: cover;
            background-position: center;
            background-attachment: fixed;
        }

        #desk {
            position: relative;
            width: 80%;
            height: 80%;
            background-color: rgba(210, 180, 140, 0.2);
            border-radius: 10px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.5);
            display: flex;
            justify-content: center;
            align-items: center;
            padding: 20px;
            box-sizing: border-box;
            backdrop-filter: blur(3px);
            border: 1px solid rgba(139, 69, 19, 0.3);
        }

        #book {
            width: 400px;
            height: 550px;
            position: relative;
            perspective: 1500px;
            cursor: pointer;
            transform-style: preserve-3d;
            transition: transform 0.5s;
            margin: 0 auto;  /* 책을 가운데 정렬 */
        }

        #book:hover {
            transform: translateY(-5px);
        }

        .cover {
            width: 100%;
            height: 100%;
            position: absolute;
            background: linear-gradient(15deg, #5D2906, #8B4513);
            border-radius: 5px 15px 15px 5px;
            box-shadow: 5px 10px 30px rgba(0, 0, 0, 0.6);
            display: flex;
            justify-content: center;
            align-items: center;
            color: #FFD700;
            font-size: 24px;
            font-weight: bold;
            transform-origin: left;
            transition: transform 1.5s ease-in-out;
            backface-visibility: visible;
            z-index: 10;
            border: 1px solid #3A2702;
            text-align: center;
            padding: 20px;
        }

        .cover h1 {
            text-align: center;
            font-size: 100%;
            padding: 20px;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.7);
            margin: 0;
            line-height: 1.3;
            font-family: 'Nanum Myeongjo', serif;
        }

        .cover::after {
            content: '';
            position: absolute;
            top: 15px;
            right: 15px;
            bottom: 15px;
            left: 15px;
            border: 1px solid rgba(255, 215, 0, 0.2);
            border-radius: 3px 13px 13px 3px;
            pointer-events: none;
        }

        .page {
            position: absolute;
            width: 100%;
            height: 100%;
            background-color: #FFF8E7;
            border-radius: 5px 15px 15px 5px;
            box-shadow: inset 0 0 15px rgba(0, 0, 0, 0.1);
            padding: 25px;
            box-sizing: border-box;
            display: none;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            overflow-y: auto;
            border-left: 1px solid #D2B48C;
        }

        .page.active {
            display: flex;
            animation: pageAppear 0.8s ease-out;
        }

        @keyframes pageAppear {
            0% { opacity: 0; transform: translateX(30px); }
            100% { opacity: 1; transform: translateX(0); }
        }

        .photo-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            grid-gap: 12px;
            width: 100%;
            max-width: 400px;
            margin-bottom: 25px;
        }

        .photo {
            width: 100%;
            height: 0;
            padding-bottom: 100%;
            background-size: cover;
            background-position: center;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s;
            position: relative;
            overflow: hidden;
            border: 3px solid #E0D0B1;
            box-shadow: 0 3px 10px rgba(0,0,0,0.1);
        }

        .photo:hover {
            transform: scale(1.08);
            box-shadow: 0 5px 20px rgba(0,0,0,0.2);
            border-color: #D2B48C;
        }

        .photo::after {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: rgba(0, 0, 0, 0.2);
            transition: all 0.3s;
        }

        .photo.selected::after {
            background-color: rgba(46, 204, 113, 0.4);
            box-shadow: inset 0 0 0 3px #2ECC71;
        }

        .photo.wrong::after {
            background-color: rgba(231, 76, 60, 0.4);
            box-shadow: inset 0 0 0 3px #E74C3C;
        }

        .message {
            text-align: center;
            margin-bottom: 25px;
            font-size: 18px;
            color: #5D2906;
            font-weight: bold;
            text-shadow: 1px 1px 2px rgba(0,0,0,0.1);
            font-family: 'Nanum Gothic', sans-serif;
        }

        .error-message {
            color: #A52A2A;
            font-weight: bold;
            margin-bottom: 20px;
            display: none;
            text-shadow: 1px 1px 2px rgba(0,0,0,0.1);
            font-size: 16px;
        }

        button {
            padding: 12px 25px;
            background: linear-gradient(to bottom, #8B4513, #A0522D);
            color: #FFD700;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-size: 16px;
            transition: all 0.3s;
            box-shadow: 0 4px 8px rgba(0,0,0,0.2);
            font-weight: bold;
            font-family: 'Nanum Gothic', sans-serif;
            letter-spacing: 1px;
        }

        button:hover {
            background: linear-gradient(to bottom, #A0522D, #8B4513);
            transform: translateY(-3px);
            box-shadow: 0 6px 12px rgba(0,0,0,0.3);
        }

        .letter {
            width: 100%;
            height: 100%;
            padding: 30px;
            box-sizing: border-box;
            background-color: #FFF8E7;
            border: 1px solid #D2B48C;
            font-family: 'Nanum Pen Script', cursive;
            font-size: 24px;
            line-height: 1.8;
            white-space: pre-line;
            overflow-y: auto;
            position: relative;
            box-shadow: inset 0 0 10px rgba(0,0,0,0.05);
            border-radius: 5px;
        }

        .letter-content {
            margin-bottom: 20px;
            position: relative;
            z-index: 1;
        }

        .signature {
            text-align: right;
            margin-top: 40px;
            font-weight: bold;
            font-size: 28px;
        }

        @keyframes flip {
            0% { transform: rotateY(0); }
            100% { transform: rotateY(-180deg); }
        }

        .flipping {
            animation: flip 1.5s forwards;
        }

        .book-spine {
            position: absolute;
            left: -20px;
            top: 0;
            height: 100%;
            width: 20px;
            background: linear-gradient(to right, #3A2702, #5D2906);
            border-radius: 5px 0 0 5px;
            box-shadow: inset -5px 0 15px rgba(0,0,0,0.4);
            z-index: 5;
        }

        

        .desk-items {
            position: absolute;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: -1;
        }

        .desk-item {
            position: absolute;
            opacity: 0.8;
        }

        .page-turn-effect {
            position: absolute;
            width: 100%;
            height: 100%;
            background-color: rgba(255, 255, 255, 0.7);
            z-index: 20;
            pointer-events: none;
            opacity: 0;
            transition: opacity 0.5s;
        }
        @media (max-width: 768px) {
            #desk {
                width: 90%;  /* 화면 크기에 맞게 90%로 설정 */
                height: 70%; /* 높이는 적당히 줄여서 비율 유지 */
            }
            #book {
                width: 80%;  /* 책 크기도 80%로 설정 */
                max-width: 300px; /* 최대 너비 제한 */
            }
        }

        @media (max-width: 480px) {
            #desk {
                width: 95%; /* 화면 크기에 맞게 95%로 설정 */
                height: 60%; /* 높이를 더 줄여서 책의 비율을 맞춤 */
            }
            #book {
                width: 90%;  /* 책 크기도 90%로 설정 */
                max-width: 250px; /* 최대 너비 제한 */
            }
        }
    </style>
    <link href="https://fonts.googleapis.com/css2?family=Nanum+Pen+Script&family=Nanum+Myeongjo:wght@700&family=Nanum+Gothic:wght@700&display=swap" rel="stylesheet">
</head>
<body>
    <div id="desk">
        <div id="book">
            <div class="book-spine"></div>
            <div class="cover" id="book-cover">
                <h1>그해 우리들의 블루스</h1>
            </div>
            <div class="page" id="page1">
                <div class="message">우리의 추억을 시간 순서대로 맞춰보세요!</div>
                <div class="error-message">왜 못맞춰 바보야 ㅠㅠ</div>
                <div class="photo-grid" id="photo-grid"></div>
                <button id="retry-btn" style="display: none;">다시하기</button>
            </div>
            <div class="page" id="page2">
                <div class="letter">
                    <div class="letter-content" id="letter-content">
                        사랑하는 내 여자친구에게,

                        알게된지 10년, 여자친구로 지낸지 1년이네. 1주년 축하해
                        
                        사랑표현 많이 못해줘서 미안해. 
                        사랑하는건 그대론데 아니 같이 보내는 시간이 길어질수록 더 소중해지는데
                        오히려 너가 불안해하고 계속 사랑을 확인하게 만들어서 미안해. 
                        당시에 여러 잡생각 들면서 혼자 스트레스 받고 예민해지고 그러면서 마음에 여유가 좀 없었나봐.
                        그래서 말에 영혼도 없는거같고 진심도 안느껴지고 그냥 말하는데도 너가 듣기엔 킹받는 투였던것 같아
                        항상 말하고 나서야 '아 이게 아닌데..' 그러려던게 아닌데 잘 안되니까 짜증만 나더라
                        이 시기만 지나면 괜찮아지겠지 하고 생각하면서 보냈어. 
                        
                        넌 의지해도 된다고 하는데 내눈엔 너가 너무 애기라 의지하고 그러기가 좀 그래
                        유치원생한테 의지하고싶은 늙은이가 어딨나
                        반 장난이고 지금도 많이 의지하고 있어. 
                        지금으로도 충분해. 날 좋다고 해주는 너가 늘 고마워

                        좋은날에 우울한 얘기해서 미안. 곧 학기도 끝나고 방학인데 대차게 놀자. 
                        선물도 사주고 싶고, 여행도 가고 싶고, 맛있는것도 많이 먹고 싶어.
                        갖고싶은거 생각해놔 크리스마스때처럼 사줄게

                        이걸로 떼울게 아니라 손편지도 줄거야 걱정마 ㅋㅋ

                        항상 서투르고 답답한 나랑 사겨줘서 고맙다
                        앞으로도 함께 많은 추억 만들자.

                        많이 사랑해.
                    </div>
                    <div class="signature">너의 남자친구가</div>
                </div>
            </div>
            <div class="page-turn-effect" id="page-turn-effect"></div>
        </div>
    </div>

    <audio id="bg-music" loop>
        <source src="music.mp3" type="audio/mp3">
        Your browser does not support the audio element.
    </audio>
    <audio id="page-turn-sound" src="https://assets.mixkit.co/sfx/preview/mixkit-book-page-turning-914.mp3"></audio>
    <audio id="click-sound" src="https://assets.mixkit.co/sfx/preview/mixkit-modern-click-box-check-1120.mp3"></audio>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            const bookCover = document.getElementById('book-cover');
            const page1 = document.getElementById('page1');
            const page2 = document.getElementById('page2');
            const photoGrid = document.getElementById('photo-grid');
            const errorMessage = document.querySelector('.error-message');
            const retryBtn = document.getElementById('retry-btn');
            const bgMusic = document.getElementById('bg-music');
            const letterContent = document.getElementById('letter-content');
            const pageTurnSound = document.getElementById('page-turn-sound');
            const clickSound = document.getElementById('click-sound');
            const pageTurnEffect = document.getElementById('page-turn-effect');
            
            // 음악 자동 재생
            document.body.addEventListener('click', function() {
                bgMusic.play().catch(e => console.log("Audio play failed:", e));
            }, { once: true });


            // 사진 데이터
            const photos = [
                { id: 1, url: 'photo1.jpg', order: 1 },
                { id: 2, url: 'photo2.jpg', order: 2 },
                { id: 3, url: 'photo3.jpg', order: 3 },
                { id: 4, url: 'photo4.jpg', order: 4 },
                { id: 5, url: 'photo5.jpg', order: 5 },
                { id: 6, url: 'photo6.jpg', order: 6 },
                { id: 7, url: 'photo7.jpg', order: 7 },
                { id: 8, url: 'photo8.jpg', order: 8 },
                { id: 9, url: 'photo9.jpg', order: 9 }
            ];

            let shuffledPhotos = [];
            let currentOrder = 1;
            let selectedPhotos = [];

            // 책 표지 클릭 이벤트
            bookCover.addEventListener('click', function() {
                bookCover.classList.add('flipping');
                pageTurnSound.play();
                setTimeout(() => {
                    bookCover.style.display = 'none';
                    pageTurnEffect.style.opacity = '1';
                    setTimeout(() => {
                        pageTurnEffect.style.opacity = '0';
                        page1.classList.add('active');
                    }, 500);
                    initPhotoGame();
                }, 1500);
            });

            // 사진 게임 초기화
            function initPhotoGame() {
                currentOrder = 1;
                selectedPhotos = [];
                shuffledPhotos = [...photos].sort(() => Math.random() - 0.5);
                renderPhotos();
                errorMessage.style.display = 'none';
                retryBtn.style.display = 'none';
            }

            // 사진 렌더링
            function renderPhotos() {
                photoGrid.innerHTML = '';
                shuffledPhotos.forEach(photo => {
                    const photoElement = document.createElement('div');
                    photoElement.className = 'photo';
                    photoElement.style.backgroundImage = `url(${photo.url})`;
                    photoElement.dataset.id = photo.id;
                    photoElement.dataset.order = photo.order;
                    photoElement.addEventListener('click', () => {
                        clickSound.currentTime = 0;
                        clickSound.play();
                        selectPhoto(photoElement);
                    });
                    photoGrid.appendChild(photoElement);
                });
            }

            // 사진 선택
            function selectPhoto(photoElement) {
                const order = parseInt(photoElement.dataset.order);
                
                if (order === currentOrder) {
                    photoElement.classList.add('selected');
                    selectedPhotos.push(photoElement);
                    currentOrder++;
                    
                    if (currentOrder > photos.length) {
                        setTimeout(() => {
                            pageTurnEffect.style.opacity = '1';
                            pageTurnSound.play();
                            setTimeout(() => {
                                page1.classList.remove('active');
                                pageTurnEffect.style.opacity = '0';
                                page2.classList.add('active');
                            }, 500);
                        }, 1000);
                    }
                } else {
                    photoElement.classList.add('wrong');
                    errorMessage.style.display = 'block';
                    retryBtn.style.display = 'block';
                }
            }

            // 다시하기 버튼
            retryBtn.addEventListener('click', function() {
                clickSound.play();
                initPhotoGame();
            });
        });
    </script>
</body>
</html>
